<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yeogil.web.mapper.ScheduleMapper">

<resultMap id="result" type="hashmap">
	<id property="countrySeq" column="COUNTRY_SEQ"/>
	<result property="countryName" column="COUNTRY_NAME"/>
  	<result property="countryEname" column="COUNTRY_ENAME"/>
  	<result property="continentName" column="CONTINENT_NAME"/>
</resultMap>
	<select id="countSchedules" resultType="int" >
		SELECT COUNT(*)
		FROM yeogil.SCHEDULE
	</select>

	<select id="selectMemOneSchedule" resultMap="result" parameterType="com.yeogil.web.controller.Proxy">
		SELECT MEMSCHCTIY.MS_CTIY_SEQ, MS_DAY, MS_DATE, MS_COUNTRY_NAME, MS_CITY_NAME
		FROM MEMSCHATTR
			JOIN MEMSCHCTIY ON MEMSCHATTR.MS_CTIY_SEQ = MEMSCHCTIY.MS_CTIY_SEQ
			JOIN MEMSCH ON MEMSCH.MS_SEQ = MEMSCHCTIY.MS_SEQ
			JOIN MEMBER ON MEMBER.MEMBER_ID = MEMSCH.MEMBER_ID
		WHERE MEMBER.MEMBER_ID LIKE #{id}
			AND MEMSCH.MS_TITLE LIKE #{title}
		GROUP BY MEMSCHCTIY.MS_CTIY_SEQ, MS_DAY, MS_DATE, MS_COUNTRY_NAME, MS_CITY_NAME
		
		<!-- SELECT * 
		FROM MEMSCHATTR 
			JOIN MEMSCHCTIY ON MEMSCHATTR.MS_CTIY_SEQ = MEMSCHCTIY.MS_CTIY_SEQ
			JOIN MEMSCH ON MEMSCH.MS_SEQ = MEMSCHCTIY.MS_SEQ
			JOIN MEMBER ON MEMBER.MEMBER_ID = MEMSCH.MEMBER_ID
		WHERE MEMBER.MEMBER_ID LIKE #{id}
			AND MEMSCH.MS_TITLE LIKE #{title} -->
	</select>
	
	<select id="selectMemOneScheAttr" resultMap="result" parameterType="com.yeogil.web.controller.Proxy">
		SELECT MS_ATTR_NAME, MS_DAY
		FROM MEMSCHATTR 
			JOIN MEMSCHCTIY ON MEMSCHATTR.MS_CTIY_SEQ = MEMSCHCTIY.MS_CTIY_SEQ
			JOIN MEMSCH ON MEMSCH.MS_SEQ = MEMSCHCTIY.MS_SEQ
			JOIN MEMBER ON MEMBER.MEMBER_ID = MEMSCH.MEMBER_ID
		WHERE MEMBER.MEMBER_ID LIKE #{id}
			AND MEMSCH.MS_TITLE LIKE #{title}
	</select>
	
	
	<select id="selectMemAllSchedules" resultMap="result" parameterType="string">
		SELECT *,(SELECT IMG_URL FROM IMAGE
				WHERE IMG_NAME LIKE MEMSCH.MS_COUNTRY_NAME) IMG_URL
		FROM MEMSCH	JOIN MEMBER ON MEMBER.MEMBER_ID = MEMSCH.MEMBER_ID
			WHERE MEMBER.MEMBER_ID LIKE #{value}
	</select>
	
</mapper>